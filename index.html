<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title data-i18n="index.title">GhostWriter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="font-family.css" />
  <link rel="icon" href="assets/images/fantasma2.png" type="image/x-icon" />
  <script type="module">
    import { abrirApp } from './scripts/apps.js';

    const stored = localStorage.getItem("preferredLang");
    let lang;

    if (stored && ["es", "en", "fr", "de", "it", "pt", "ru", "zh"].includes(stored)) {
      lang = stored;
    } else {
      const nav = (navigator.language || navigator.userLanguage || "en").slice(0, 2);
      lang = ["es", "en", "fr", "de", "it", "pt", "ru", "zh"].includes(nav) ? nav : "en";
      localStorage.setItem("preferredLang", lang);
    }

    const dayGame = localStorage.getItem("dayGame");
    if (!dayGame) {
      localStorage.setItem("dayGame", 0);
    } else if (dayGame == 6) {
      abrirApp("Firefox");
      const dock = document.getElementById("dock");
      if (dock) {
        dock.style.display = "none";
      }
      const end = document.getElementById("btnTerminarJuego");
      if (end) {
        setTimeout(() => {
          end.classList.remove("hidden");
        }, 3000);
      }

    }

    const session = localStorage.getItem("session");
    if (!session) {
      window.location.replace("./components/start/start.html");
    }
  </script>



</head>

<body>

  <div id="videoContainer" class="fixed inset-0 z-50 bg-black flex items-center justify-center hidden">
    <video id="videoPlayer" autoplay muted playsinline></video>
  </div>

  <div id="mainContent">

    <div id="topbar" class="z-50 relative">
      <div class="left">
        <i class="fa-solid fa-ghost cursor-not-allowed pointer-events-none">
          <span data-i18n="index.beta">Beta</span>
        </i>
      </div>
      <div class="center" id="topbar-date"></div>
      <div class="right">
        <i id="btnSonido" class="fa-solid fa-volume-high cursor-pointer"></i>
        <i class="fa-solid fa-wifi"></i>
        <i class="fa-solid fa-battery-full cursor-not-allowed pointer-events-none"></i>
        <i id="btnApagar" class="fa-solid fa-power-off cursor-pointer"></i>
        <button id="btnCerrarModal"
          class="ml-3 p-1 rounded hover:bg-gray-700 cursor-pointer text-white text-xl font-bold"
          style="display:none;">×</button>
      </div>
    </div>


    <main>
      <div class="icon cursor-pointer inline-flex flex-col items-center gap-1" onclick="abrirApp('Correo')">
        <div class="relative inline-block leading-none">
          <i class="fa-solid fa-envelope text-3xl block"></i>
          <span class="badge-ayuda" style="display: flex;color:white;">?</span>
        </div>
        <span data-i18n="index.mail">Mail-Coach</span>
      </div>

      <div class="icon cursor-pointer" onclick="abrirApp('Firefox')">
        <i class="fa-brands fa-firefox-browser"></i>
        <span data-i18n="index.firefox">Firefox</span>
      </div>

      <div class="icon cursor-pointer" onclick="abrirApp('CompartirArchivos')">
        <i class="fa-solid fa-cloud-arrow-up"></i>
        <span data-i18n="index.sharedFiles">Archivos compartidos</span>
      </div>

      <div class="icon cursor-pointer" onclick="abrirApp('Ghost')">
        <i class="fa-solid fa-file-alt"></i>
        <span data-i18n="index.focuswriter">FocusWriter</span>
      </div>

      <div class="icon cursor-pointer" onclick="abrirApp('Configuración')">
        <i class="fa-solid fa-gear"></i>
        <span data-i18n="index.settings">Configuración</span>
      </div>
    </main>

    <div id="dock" class="z-40 relative">
      <i class="fa-solid fa-envelope cursor-pointer" onclick="abrirApp('Correo')"></i>
      <i class="fa-brands fa-firefox-browser cursor-pointer" onclick="abrirApp('Firefox')"></i>
      <i class="fa-solid fa-cloud-arrow-up cursor-pointer" onclick="abrirApp('CompartirArchivos')"></i>
      <i class="fa-solid fa-file-alt cursor-pointer" onclick="abrirApp('Ghost')"></i>
      <i class="fa-solid fa-gear cursor-pointer" onclick="abrirApp('Configuración')"></i>
    </div>

  </div>

  <div id="modalGeneral"
    class="hidden fixed inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50 overflow-hidden">
    <div class="w-full h-full relative flex flex-col">
      <iframe id="iframeModal" src="" frameborder="0" class="w-full h-full bg-black pt-8"></iframe>
    </div>
  </div>

  <div id="modalSalir" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-60">
    <div class="bg-gray-900 p-6 rounded-lg max-w-sm text-center text-white">
      <p class="mb-4 text-lg" data-i18n="index.exitMessage">¿Está seguro que quiere salir? Si lo hace perderá la
        partida.</p>
      <div class="flex justify-around">
        <button id="confirmarSalir" class="px-4 py-2 bg-red-600 rounded hover:bg-red-700"
          data-i18n="index.exit">Salir</button>
        <button id="cancelarSalir" class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600"
          data-i18n="index.cancel">Cancelar</button>
      </div>
    </div>
  </div>
  <button id="btnTerminarJuego" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2
         z-50 flex items-center gap-4 px-14 py-8
         text-3xl font-extrabold text-white
         bg-[#E95420]/25 rounded-3xl
         backdrop-blur-lg border-4 border-[#E95420]/50
         shadow-[0_0_40px_rgba(233,84,32,0.8),0_0_80px_rgba(233,84,32,0.6)]
         hover:bg-[#E95420]/35 hover:shadow-[0_0_60px_rgba(233,84,32,1),0_0_100px_rgba(233,84,32,0.8)]
         hover:scale-110 active:scale-95
         animate-pulse transition-all duration-500">
    <i class="fas fa-ghost text-4xl" data-i18n="index.revelate"></i> Revelar Destino
  </button>

  <audio id="clickSound" src="./assets/audio/click-234708.mp3" preload="auto"></audio>

  <script type="module" src="./scripts/main.js"></script>
  <script src="./scripts/i18n.js"></script>

</body>

</html>